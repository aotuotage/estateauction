{"ast":null,"code":"function GameCanvas(canvas, width, height, settings) {\n  var _this = this;\n\n  if (arguments.length == 0) {\n    canvas = null;\n    width = \"FULLSCREEN\";\n  }\n\n  if (typeof canvas === \"string\") canvas = document.getElementById(canvas);\n  this.canvas = canvas || document.body.appendChild(document.createElement(\"canvas\"));\n  width = width || \"FULLSCREEN\";\n\n  if (width == \"FULLSCREEN\") {\n    settings = height || settings;\n    document.body.style = settings && settings.appliedBodyStyle || \"padding: 0;margin: 0;overflow: hidden;\";\n    this.canvas.height = window.innerHeight;\n  } else {\n    this.canvas.height = height;\n  }\n\n  this.canvas.width = width == \"FULLSCREEN\" ? window.innerWidth : width;\n  this.ctx = this.canvas.getContext(\"2d\");\n  this.settings = settings;\n  this.globalFunctions = settings && settings.hasOwnProperty(\"globalFunctions\") ? settings.globalFunctions : true;\n  this.topFunction = this.globalFunctions ? window : this;\n  this.imagesToLoad = 0;\n  this.preloadedImages = [];\n  this.storedImages = [];\n  this.storedImageData = [];\n  this.topFunction.width = this.canvas.width;\n  this.topFunction.height = this.canvas.height;\n  /* \n  \n  TODO:\n      * Buttons with click events\n      * Fix gradient\n      * Clip function\n      \n  */\n\n  /*\n  +------------------------------+\n  |            Testing           |\n  +------------------------------+\n  */\n\n  this.topFunction.isItWorking = function () {\n    msg = \"Yup, it's working!\\n(This function can be removed from your code now if you want)\";\n    console.log(msg);\n  };\n  /*\n  +------------------------------+\n  |       Public functions       |\n  +------------------------------+\n  */\n\n\n  window.onload = function () {\n    if (typeof preload !== 'undefined' && typeof preload === 'function') preload();else {\n      _this.callFunctions();\n    }\n  };\n\n  this.callFunctions = function () {\n    typeof start !== 'undefined' && start();\n\n    if (typeof loop !== 'undefined') {\n      var oldLoop = loop;\n\n      loop = function (_loop) {\n        function loop() {\n          return _loop.apply(this, arguments);\n        }\n\n        loop.toString = function () {\n          return _loop.toString();\n        };\n\n        return loop;\n      }(function () {\n        oldLoop();\n        requestAnimationFrame(loop);\n      });\n\n      loop();\n    }\n  };\n  /*\n  +------------------------------+\n  |          Rendering           |\n  +------------------------------+\n  */\n  //Clear screen\n\n\n  this.topFunction.clearScreen = function () {\n    _this.ctx.clearRect(0, 0, _this.canvas.width, _this.canvas.height);\n  }; //Fill screen\n\n\n  this.topFunction.background = function (color) {\n    _this.ctx.beginPath();\n\n    _this.ctx.fillStyle = color;\n\n    _this.ctx.fillRect(0, 0, _this.topFunction.width, _this.topFunction.height);\n\n    _this.ctx.closePath();\n  }; //DrawRectangle\n\n\n  this.topFunction.drawRectangle = function (x, y, width, height, fill, stroke, settings) {\n    _this.ctx.beginPath();\n\n    _this.ctx.rect(x, y, width, height);\n\n    _this.topFunction.renderShape(fill, stroke, settings);\n  };\n\n  this.topFunction.rect = this.topFunction.drawRectangle;\n  this.topFunction.rectangle = this.topFunction.drawRectangle; //DrawCircle\n\n  this.topFunction.drawCircle = function (x, y, radius, fill, stroke, settings) {\n    _this.ctx.beginPath();\n\n    _this.ctx.arc(x, y, radius, 0, 2 * Math.PI);\n\n    _this.ctx.closePath();\n\n    _this.topFunction.renderShape(fill, stroke, settings);\n  };\n\n  this.topFunction.circle = this.topFunction.drawCircle; //DrawRing\n\n  this.topFunction.drawRing = function (x, y, radius, color, lineWidth) {\n    _this.topFunction.drawCircle(x, y, radius, \"\", color, lineWidth ? {\n      lineWidth: lineWidth\n    } : undefined);\n  };\n\n  this.topFunction.ring = this.topFunction.drawRing; //DrawTriangle\n\n  this.topFunction.drawTriangle = function (x1, y1, x2, y2, x3, y3, fill, stroke, settings) {\n    _this.ctx.beginPath();\n\n    if (x1.hasOwnProperty(\"x\")) {\n      _this.ctx.moveTo(x1.x, x1.y);\n\n      _this.ctx.lineTo(y1.x, y1.y);\n\n      _this.ctx.lineTo(x2.x, x2.y);\n\n      color = y2;\n      settings = x3;\n    } else {\n      _this.ctx.moveTo(x1, y1);\n\n      _this.ctx.lineTo(x2, y2);\n\n      _this.ctx.lineTo(x3, y3);\n    }\n\n    _this.ctx.closePath();\n\n    _this.topFunction.renderShape(fill, stroke, settings);\n  };\n\n  this.topFunction.triangle = this.topFunction.drawTriangle;\n  this.topFunction.tri = this.topFunction.drawTriangle; //DrawTriangleEquilateral\n\n  this.topFunction.drawTriangleEquilateral = function (x, y, radius, fill, stroke, settings) {\n    var x1 = x + Math.cos(30 * Math.PI / 180) * (settings && settings.width || radius);\n    var y1 = y + Math.sin(30 * Math.PI / 180) * (settings && settings.height || radius);\n    var x2 = x + Math.cos(150 * Math.PI / 180) * (settings && settings.width || radius);\n    var y2 = y + Math.sin(150 * Math.PI / 180) * (settings && settings.height || radius);\n    var x3 = x;\n    var y3 = y - radius;\n\n    _this.topFunction.drawTriangle(x1, y1, x2, y2, x3, y3, fill, stroke, settings);\n  };\n\n  this.topFunction.triangleEq = this.topFunction.drawTriangleEquilateral;\n\n  this.topFunction.drawRegularPolygon = function (x, y, radius, vertices, fill, stroke, settings) {\n    _this.ctx.beginPath();\n\n    for (var i = -90; i < 270; i += 360 / vertices) {\n      var x1 = x + Math.cos(i * Math.PI / 180) * (settings && settings.width || radius);\n      var y1 = y + Math.sin(i * Math.PI / 180) * (settings && settings.height || radius);\n      if (i == -90) _this.ctx.moveTo(x1, y1);else _this.ctx.lineTo(x1, y1);\n    }\n\n    _this.ctx.closePath();\n\n    _this.topFunction.renderShape(fill, stroke, settings);\n  };\n\n  this.topFunction.regPolygon = this.topFunction.drawRegularPolygon; //DrawEllipse\n\n  this.topFunction.drawEllipse = function (x, y, width, height, fill, stroke, settings) {\n    _this.ctx.beginPath();\n\n    _this.ctx.ellipse(x, y, width, height, settings && settings.rotation || 0, 0, Math.PI * 2);\n\n    _this.ctx.closePath();\n\n    _this.topFunction.renderShape(fill, stroke, settings);\n  };\n\n  this.topFunction.ellipse = this.topFunction.drawEllipse;\n  this.topFunction.oval = this.topFunction.drawEllipse; //PreloadImage\n\n  this.topFunction.preloadImage = function (src) {\n    var element = _this.preloadedImages.find(function (elem) {\n      return elem.src === src;\n    });\n\n    console.log(\"Preloading image... \" + src);\n\n    if (!element) {\n      _this.imagesToLoad++;\n      var img = new Image();\n      img.src = src;\n\n      img.onload = function () {\n        _this.imagesToLoad--;\n\n        if (_this.imagesToLoad <= 0) {\n          _this.callFunctions();\n        }\n\n        console.log(\"Image preloaded! \" + img.src);\n      };\n\n      _this.preloadedImages.push({\n        src: src,\n        image: img\n      });\n\n      return img;\n    }\n  }; //DrawImage\n\n\n  this.topFunction.drawImage = function (src, x, y, width, height, settings) {\n    var loadedImage = _this.preloadedImages.find(function (elem) {\n      return elem.src === src;\n    });\n\n    if (loadedImage) {\n      if (settings && settings.rotation !== undefined && settings.rotation !== null) {\n        _this.ctx.save();\n\n        _this.ctx.translate(x, y);\n\n        _this.ctx.rotate(settings.rotation);\n\n        _this.ctx.drawImage(loadedImage.image, -width / 2, -height / 2, width, height);\n\n        _this.ctx.restore();\n      } else {\n        _this.ctx.drawImage(loadedImage.image, x, y, width, height);\n      }\n    } else {\n      var prel = _this.topFunction.preloadImage(src);\n\n      prel.onload = function () {\n        _this.ctx.drawImage(prel, x, y, width, height);\n      };\n    }\n  };\n\n  this.topFunction.image = this.topFunction.drawImage;\n  this.topFunction.picture = this.topFunction.drawImage;\n\n  this.topFunction.imageReadPixel = function (imageSrc, x, y) {\n    var reader = _this.storedImageData.find(function (elem) {\n      return elem.src === imageSrc;\n    });\n\n    if (reader) {\n      if (reader.imagePixelReader.isDoneLoading) return reader.imagePixelReader.readPixel(x, y);else return \"Data is added, but has not loaded yet\";\n    } else {\n      var newReader = new _this.topFunction.ImagePixelReader(imageSrc);\n\n      _this.storedImageData.push({\n        src: imageSrc,\n        imagePixelReader: newReader\n      });\n\n      return newReader.readPixel(x, y);\n    }\n  }; //ImagePixelReader\n\n\n  this.topFunction.ImagePixelReader = function (imageSrc) {\n    var top = this;\n\n    var loadedImage = _this.preloadedImages.find(function (elem) {\n      return elem.src === imageSrc;\n    });\n\n    if (loadedImage) {\n      top.image = loadedImage.image;\n      top.isDoneLoading = true;\n      top.canvas = document.createElement(\"canvas\");\n      top.canvas.width = top.image.width;\n      top.canvas.height = top.image.height;\n      top.ctx = top.canvas.getContext(\"2d\");\n      top.ctx.drawImage(top.image, 0, 0);\n      top.imageData = top.ctx.getImageData(0, 0, top.image.width, top.image.height).data;\n    } else {\n      console.error(\"Please preload image before getting data!\");\n      /*this.isDoneLoading = false;\n      this.image.onload = function() {\n          top.canvas = document.createElement(\"canvas\");\n          top.canvas.width = top.image.width;\n          top.canvas.height = top.image.height;\n          top.ctx = top.canvas.getContext(\"2d\");\n      \n          top.ctx.drawImage(top.image, 0, 0);\n          top.imageData = top.ctx.getImageData(0, 0, top.image.width, top.image.height).data;\n          top.isDoneLoading = true;\n          \n          top.onload();\n      }*/\n    }\n\n    this.readPixel = function (x, y) {\n      if (top.isDoneLoading) {\n        var index = (x + y * top.image.height) * 4;\n        return [top.imageData[index], top.imageData[index + 1], top.imageData[index + 2], top.imageData[index + 3]];\n      } else {\n        console.log(\"Is loading!..\");\n      }\n    };\n\n    this.onload = function () {};\n  }; //DrawLine\n\n\n  this.topFunction.drawLine = function (x1, y1, x2, y2, color, settings) {\n    _this.ctx.beginPath();\n\n    if (x1.hasOwnProperty(\"x\")) {\n      _this.ctx.moveTo(x1.x, x1.y);\n\n      _this.ctx.lineTo(y1.x, y1.y);\n\n      color = x2;\n      settings = y2;\n    } else {\n      _this.ctx.moveTo(x1, y1);\n\n      _this.ctx.lineTo(x2, y2);\n    }\n\n    _this.ctx.closePath();\n\n    _this.ctx.lineCap = settings && settings.roundedCorners ? \"round\" : \"butt\";\n    _this.ctx.strokeStyle = color;\n    _this.ctx.lineWidth = settings && settings.lineWidth || 2;\n\n    _this.ctx.stroke();\n  };\n\n  this.topFunction.line = this.topFunction.drawLine; //DrawPoint\n\n  this.topFunction.drawPoint = function (x, y) {\n    if (x.hasOwnProperty(\"x\")) {\n      y = x.y;\n      x = x.x;\n    }\n\n    _this.topFunction.drawCircle(x, y, 5, \"black\");\n  };\n\n  this.topFunction.point = this.topFunction.drawPoint; //DrawText\n\n  this.topFunction.drawText = function (text, x, y, fontSize, fill, stroke, settings) {\n    if (typeof stroke === \"object\" && stroke.toString() === \"[object Object]\") {\n      settings = stroke;\n      stroke = \"\";\n    }\n\n    _this.ctx.beginPath();\n\n    _this.ctx.font = (fontSize || 30) + \"px \" + (settings && settings.fontFamily) || \"Arial\";\n    _this.ctx.textAlign = settings && settings.alignText || \"left\";\n    _this.ctx.lineWidth = settings && settings.lineWidth || 2;\n\n    _this.ctx.closePath();\n\n    if (fill) {\n      _this.ctx.fillStyle = fill;\n\n      _this.ctx.fillText(text, x, y);\n    }\n\n    if (stroke) {\n      _this.ctx.strokeStyle = stroke;\n\n      _this.ctx.strokeText(text, x, y);\n    }\n  };\n\n  this.topFunction.text = this.topFunction.drawText; //RenderShape\n\n  this.topFunction.drawPolygon = function (list, fill, stroke, settings) {\n    var newList = list.constructor === Array ? list : arguments;\n\n    _this.ctx.beginPath();\n\n    _this.ctx.moveTo(newList[0].x, newList[0].y);\n\n    for (var i = 1; i < newList.length; i++) {\n      var p = newList[i];\n\n      _this.ctx.lineTo(p.x, p.y);\n    }\n\n    _this.ctx.closePath();\n\n    _this.topFunction.renderShape(fill, stroke, settings);\n  };\n\n  this.topFunction.polygon = this.topFunction.drawPolygon;\n\n  this.topFunction.gradient = function (startColor, endColor, radius, settings) {\n    var arr;\n\n    if (startColor.constructor === Array) {\n      settings = radius;\n      radius = endColor;\n      arr = startColor;\n    } else {\n      arr = [startColor, endColor];\n    }\n\n    var gradient = _this.ctx.createLinearGradient(0, 0, 0, radius || 100);\n\n    for (var i = 0; i < arr.length; i++) {\n      gradient.addColorStop(1 / (arr.length - 1) * i, arr[i]);\n    }\n\n    return gradient;\n  }; //Custom shape\n\n\n  this.topFunction.beginShape = function () {\n    _this.ctx.beginPath();\n  };\n\n  this.topFunction.moveTo = function (x, y) {\n    _this.ctx.moveTo(x, y);\n  };\n\n  this.topFunction.lineTo = function (x, y) {\n    _this.ctx.lineTo(x, y);\n  };\n\n  this.topFunction.curveTo = function (x, y, x2, y2) {\n    _this.ctx.quadraticCurveTo(x2, y2, x, y);\n  };\n\n  this.topFunction.closeShape = function () {\n    _this.ctx.closePath();\n  };\n\n  this.topFunction.renderShape = function (fill, stroke, settings) {\n    if (typeof fill === \"object\" && fill.toString() === \"[object Object]\") {\n      settings = fill;\n      fill = \"\";\n    }\n\n    if (typeof stroke === \"object\" && stroke.toString() === \"[object Object]\") {\n      settings = stroke;\n      stroke = \"\";\n    }\n\n    _this.ctx.lineJoin = settings && settings.roundedCorners ? \"round\" : \"miter\";\n    _this.ctx.lineWidth = settings && settings.lineWidth || 2;\n\n    if (settings && settings.hasOwnProperty(\"fillColor\")) {\n      _this.ctx.fillStyle = settings.fillColor;\n\n      _this.ctx.fill();\n    }\n\n    if (settings && settings.hasOwnProperty(\"strokeColor\")) {\n      _this.ctx.strokeStyle = settings.strokeColor;\n\n      _this.ctx.stroke();\n    }\n\n    if (fill) {\n      _this.ctx.fillStyle = fill;\n\n      _this.ctx.fill();\n    }\n\n    if (stroke) {\n      _this.ctx.strokeStyle = stroke;\n\n      _this.ctx.stroke();\n    }\n  };\n  /*\n  +------------------------------+\n  |      Pixel manipulation      |\n  +------------------------------+\n  */\n\n\n  this.topFunction.pixels = [];\n  this.imageData;\n\n  this.topFunction.updatePixelData = function () {\n    _this.imageData = _this.ctx.getImageData(0, 0, _this.canvas.width, _this.canvas.height);\n    _this.topFunction.pixels = _this.imageData.data;\n  };\n\n  this.topFunction.updatePixel = function (x, y, r, g, b, a) {\n    var index = (x + y * _this.canvas.width) * 4;\n    _this.topFunction.pixels[index] = r;\n    _this.topFunction.pixels[index + 1] = g;\n    _this.topFunction.pixels[index + 2] = b;\n    _this.topFunction.pixels[index + 3] = typeof a === 'undefined' ? 255 : a;\n  };\n\n  this.topFunction.readPixel = function (x, y) {\n    var index = (x + y * _this.canvas.width) * 4;\n    return [_this.topFunction.pixels[index], _this.topFunction.pixels[index + 1], _this.topFunction.pixels[index + 2], _this.topFunction.pixels[index + 3]];\n  };\n\n  this.topFunction.renderPixelData = function () {\n    _this.ctx.putImageData(_this.imageData, 0, 0);\n  };\n  /*\n  +------------------------------+\n  |             Math             |\n  +------------------------------+\n  */\n  //Distance\n\n\n  this.topFunction.getDistance = function (x1, y1, x2, y2) {\n    if (x1.hasOwnProperty(\"x\")) {\n      y2 = y1.y;\n      x2 = y1.x;\n      y1 = x1.y;\n      x1 = x1.x;\n    }\n\n    var a = x1 - x2;\n    var b = y1 - y2;\n    return Math.sqrt(a * a + b * b);\n  };\n\n  this.topFunction.distance = this.topFunction.getDistance; //Angle\n\n  this.topFunction.getAngle = function (x1, y1, x2, y2, settings) {\n    if (x1.hasOwnProperty(\"x\")) {\n      settings = x2;\n      y2 = y1.y;\n      x2 = y1.x;\n      y1 = x1.y;\n      x1 = x1.x;\n    }\n\n    if (settings && settings.angleMode && (settings.angleMode.toUpperCase() == \"DEG\" || settings.angleMode.toUpperCase() == \"DEGREES\")) return Math.atan2(y2 - y1, x2 - x1) * 180 / Math.PI;else if (settings && settings.angleMode && (settings.angleMode.toUpperCase() == \"RAD\" || settings.angleMode.toUpperCase() == \"RADIUS\") || !settings) return Math.atan2(y2 - y1, x2 - x1);\n  }; //Random functions\n\n\n  this.topFunction.random = function (min, max) {\n    if (typeof max == \"undefined\") return Math.random() * min;else return Math.random() * (max - min) + min;\n  };\n\n  this.topFunction.randomInt = function (min, max) {\n    if (typeof max == \"undefined\") return Math.random() * min >> 0;else return Math.random() * (max - min) + min >> 0;\n  };\n\n  this.topFunction.randomArray = function (array) {\n    return array[Math.random() * array.length >> 0];\n  };\n  /*\n  +------------------------------+\n  |        Export canvas         |\n  +------------------------------+\n  */\n\n\n  this.topFunction.canvasToURL = function () {\n    return _this.canvas.toDataURL();\n  };\n\n  this.topFunction.canvasToImage = function () {\n    var img = new Image();\n    img.src = _this.canvas.toDataURL();\n    return img;\n  };\n\n  this.topFunction.downloadCanvasPNG = function (filename) {\n    var a = document.createElement(\"a\");\n    a.download = filename || \"downloadCanvasPNG.png\";\n    a.href = _this.canvas.toDataURL();\n    a.click();\n  };\n  /*\n  +------------------------------+\n  |              Misc.           |\n  +------------------------------+\n  */\n\n\n  this.topFunction.swap = function (a, b) {\n    return [b, a];\n  };\n\n  this.topFunction.createArray = function (n, lengths) {\n    return create2dArray(0, n, lengths || 10);\n  };\n\n  function create2dArray(count, n, lengths) {\n    var a = new Array(lengths);\n\n    for (var i = 0; i < a.length; i++) {\n      a[i] = count < n - 2 ? create2dArray(count + 1, n, lengths) : new Array(lengths);\n    }\n\n    return a;\n  }\n  /*\n  +------------------------------+\n  |         Input / events       |\n  +------------------------------+\n  */\n\n\n  this.topFunction.mouse = {\n    x: 0,\n    y: 0,\n    left: false,\n    middle: false,\n    right: false\n  };\n  this.topFunction.mouseX = 0;\n  this.topFunction.mouseY = 0;\n  this.topFunction.touch = {\n    x: 0,\n    y: 0,\n    touching: false,\n    touches: []\n  };\n  this.keyNumber = [];\n  this.keyName = [];\n\n  this.topFunction.isKeyPressed = function (key) {\n    if (isNaN(key)) return _this.keyName[key] ? true : false;else return _this.keyNumber[key] ? true : false;\n  };\n\n  this.topFunction.getKey = this.topFunction.isKeyPressed;\n  this.canvas.addEventListener(\"mousemove\", function (e) {\n    var rect = _this.canvas.getBoundingClientRect();\n\n    _this.topFunction.mouse.x = _this.topFunction.mouseX = Math.round((e.clientX - rect.left) * (_this.topFunction.width / rect.width));\n    _this.topFunction.mouse.y = _this.topFunction.mouseY = Math.round((e.clientY - rect.top) * (_this.topFunction.height / rect.height));\n    typeof OnMouseMove === \"function\" && OnMouseMove(e);\n  });\n  this.canvas.addEventListener(\"mousedown\", function (e) {\n    switch (e.which) {\n      case 1:\n        _this.topFunction.mouse.left = true;\n        break;\n\n      case 2:\n        _this.topFunction.mouse.middle = true;\n        break;\n\n      case 3:\n        _this.topFunction.mouse.right = true;\n        break;\n    }\n\n    typeof OnMouseDown === \"function\" && OnMouseDown(e);\n  });\n  this.canvas.addEventListener(\"mouseup\", function (e) {\n    switch (e.which) {\n      case 1:\n        _this.topFunction.mouse.left = false;\n        break;\n\n      case 2:\n        _this.topFunction.mouse.middle = false;\n        break;\n\n      case 3:\n        _this.topFunction.mouse.right = false;\n        break;\n    }\n\n    typeof OnMouseUp === \"function\" && OnMouseUp(e);\n  });\n  this.canvas.addEventListener(\"touchstart\", function (e) {\n    e.preventDefault();\n    changeTouch(e);\n    _this.topFunction.touch.x = e.touches[0].pageX;\n    _this.topFunction.touch.y = e.touches[0].pageY;\n    _this.topFunction.touch.touching = true;\n    typeof OnTouchStart === \"function\" && OnTouchStart(e);\n  });\n  this.canvas.addEventListener(\"touchend\", function (e) {\n    e.preventDefault();\n    changeTouch(e);\n    _this.topFunction.touch.touching = false;\n    typeof OnTouchEnd === \"function\" && OnTouchEnd(e);\n  });\n  this.canvas.addEventListener(\"touchmove\", function (e) {\n    e.preventDefault();\n    changeTouch(e);\n\n    if (_this.settings.setMouseToTouch) {\n      _this.topFunction.touch.x = _this.topFunction.mouse.x = _this.topFunction.mouseX = e.touches[0].pageX;\n      _this.topFunction.touch.y = _this.topFunction.mouse.y = _this.topFunction.mouseY = e.touches[0].pageY;\n    } else {\n      _this.topFunction.touch.x = e.touches[0].pageX;\n      _this.topFunction.touch.y = e.touches[0].pageY;\n    }\n\n    typeof OnTouchMove === \"function\" && OnTouchMove(e);\n  });\n\n  var changeTouch = function changeTouch(e) {\n    _this.topFunction.touch.touches = [];\n\n    for (var i = 0; i < e.touches.length; i++) {\n      _this.topFunction.touch.touches.push({\n        x: e.touches[i].pageX,\n        y: e.touches[i].pageY,\n        id: e.touches[i].identifier\n      });\n    }\n  };\n\n  document.addEventListener(\"keydown\", function (e) {\n    _this.keyNumber[e.which] = true;\n    _this.keyName[e.key] = true;\n    typeof OnKeyDown === \"function\" && OnKeyDown(e);\n  });\n  document.addEventListener(\"keyup\", function (e) {\n    _this.keyNumber[e.which] = false;\n    _this.keyName[e.key] = false;\n    typeof OnKeyUp === \"function\" && OnkeyUp(e);\n  });\n}","map":{"version":3,"sources":["/Users/mac/Desktop/react/my-app/src/login/gameCanvas.js"],"names":["GameCanvas","canvas","width","height","settings","_this","arguments","length","document","getElementById","body","appendChild","createElement","style","appliedBodyStyle","window","innerHeight","innerWidth","ctx","getContext","globalFunctions","hasOwnProperty","topFunction","imagesToLoad","preloadedImages","storedImages","storedImageData","isItWorking","msg","console","log","onload","preload","callFunctions","start","loop","oldLoop","requestAnimationFrame","clearScreen","clearRect","background","color","beginPath","fillStyle","fillRect","closePath","drawRectangle","x","y","fill","stroke","rect","renderShape","rectangle","drawCircle","radius","arc","Math","PI","circle","drawRing","lineWidth","undefined","ring","drawTriangle","x1","y1","x2","y2","x3","y3","moveTo","lineTo","triangle","tri","drawTriangleEquilateral","cos","sin","triangleEq","drawRegularPolygon","vertices","i","regPolygon","drawEllipse","ellipse","rotation","oval","preloadImage","src","element","find","elem","img","Image","push","image","drawImage","loadedImage","save","translate","rotate","restore","prel","picture","imageReadPixel","imageSrc","reader","imagePixelReader","isDoneLoading","readPixel","newReader","ImagePixelReader","top","imageData","getImageData","data","error","index","drawLine","lineCap","roundedCorners","strokeStyle","line","drawPoint","point","drawText","text","fontSize","toString","font","fontFamily","textAlign","alignText","fillText","strokeText","drawPolygon","list","newList","constructor","Array","p","polygon","gradient","startColor","endColor","arr","createLinearGradient","addColorStop","beginShape","curveTo","quadraticCurveTo","closeShape","lineJoin","fillColor","strokeColor","pixels","updatePixelData","updatePixel","r","g","b","a","renderPixelData","putImageData","getDistance","sqrt","distance","getAngle","angleMode","toUpperCase","atan2","random","min","max","randomInt","randomArray","array","canvasToURL","toDataURL","canvasToImage","downloadCanvasPNG","filename","download","href","click","swap","createArray","n","lengths","create2dArray","count","mouse","left","middle","right","mouseX","mouseY","touch","touching","touches","keyNumber","keyName","isKeyPressed","key","isNaN","getKey","addEventListener","e","getBoundingClientRect","round","clientX","clientY","OnMouseMove","which","OnMouseDown","OnMouseUp","preventDefault","changeTouch","pageX","pageY","OnTouchStart","OnTouchEnd","setMouseToTouch","OnTouchMove","id","identifier","OnKeyDown","OnKeyUp","OnkeyUp"],"mappings":"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","sourcesContent":["function GameCanvas(canvas, width, height, settings) {\n    var _this = this;\n    \n    if (arguments.length == 0) {\n        canvas = null;\n        width = \"FULLSCREEN\";\n    }\n    \n    if (typeof canvas === \"string\") canvas = document.getElementById(canvas);\n    this.canvas = canvas || document.body.appendChild(document.createElement(\"canvas\"));\n    \n    width = width || \"FULLSCREEN\";\n    if (width == \"FULLSCREEN\") {\n        settings = height || settings;\n        document.body.style = (settings && settings.appliedBodyStyle) || \"padding: 0;margin: 0;overflow: hidden;\";\n        this.canvas.height = window.innerHeight;\n    }\n    else {\n        this.canvas.height = height;\n    }\n    this.canvas.width = (width == \"FULLSCREEN\" ? window.innerWidth : width);\n    \n    this.ctx = this.canvas.getContext(\"2d\");\n    \n    this.settings = settings;\n    this.globalFunctions = (settings && settings.hasOwnProperty(\"globalFunctions\")) ? settings.globalFunctions : true;\n    this.topFunction = this.globalFunctions ? window : this;\n    \n    this.imagesToLoad = 0;\n    this.preloadedImages = [];\n    this.storedImages = [];\n    this.storedImageData = [];\n    \n    this.topFunction.width = this.canvas.width;\n    this.topFunction.height = this.canvas.height;\n    \n    /* \n    \n    TODO:\n        * Buttons with click events\n        * Fix gradient\n        * Clip function\n        \n    */\n    \n    /*\n    +------------------------------+\n    |            Testing           |\n    +------------------------------+\n    */\n    \n    this.topFunction.isItWorking = function() {\n        msg = \"Yup, it's working!\\n(This function can be removed from your code now if you want)\";\n        console.log(msg);\n    };\n    \n    /*\n    +------------------------------+\n    |       Public functions       |\n    +------------------------------+\n    */\n    \n    window.onload = function() {\n        if (typeof preload !== 'undefined' && typeof preload === 'function')\n            preload();\n        else {\n            _this.callFunctions();\n        }\n    };\n    \n    this.callFunctions = function() {\n        typeof start !== 'undefined' && start();\n        if (typeof loop !== 'undefined') {\n            var oldLoop = loop;\n            loop = function() {\n                oldLoop();\n                requestAnimationFrame(loop);\n            };\n            loop();\n        }\n    };\n    \n    /*\n    +------------------------------+\n    |          Rendering           |\n    +------------------------------+\n    */\n    \n    //Clear screen\n    this.topFunction.clearScreen = function() {\n        _this.ctx.clearRect(0, 0, _this.canvas.width, _this.canvas.height);\n    };\n    \n    //Fill screen\n    this.topFunction.background = function(color) {\n        _this.ctx.beginPath();\n        _this.ctx.fillStyle = color;\n        _this.ctx.fillRect(0, 0, _this.topFunction.width, _this.topFunction.height);\n        _this.ctx.closePath();\n    }\n    \n    //DrawRectangle\n    this.topFunction.drawRectangle = function(x, y, width, height, fill, stroke, settings) {\n        _this.ctx.beginPath();\n        _this.ctx.rect(x, y, width, height);\n        \n        _this.topFunction.renderShape(fill, stroke, settings);\n    };\n    this.topFunction.rect = this.topFunction.drawRectangle;\n    this.topFunction.rectangle = this.topFunction.drawRectangle;\n    \n    \n    //DrawCircle\n    this.topFunction.drawCircle = function(x, y, radius, fill, stroke, settings) {\n        _this.ctx.beginPath();\n        _this.ctx.arc(x, y, radius, 0, 2 * Math.PI);\n        _this.ctx.closePath();\n        \n        _this.topFunction.renderShape(fill, stroke, settings);\n    };\n    this.topFunction.circle = this.topFunction.drawCircle;\n    \n    //DrawRing\n    this.topFunction.drawRing = function(x, y, radius, color, lineWidth) {\n        _this.topFunction.drawCircle(x, y, radius, \"\", color, lineWidth ? {lineWidth: lineWidth} : undefined);\n    };\n    this.topFunction.ring = this.topFunction.drawRing;\n    \n    //DrawTriangle\n    this.topFunction.drawTriangle = function(x1, y1, x2, y2, x3, y3, fill, stroke, settings) {\n        _this.ctx.beginPath();\n        if (x1.hasOwnProperty(\"x\")) {\n            _this.ctx.moveTo(x1.x, x1.y);\n            _this.ctx.lineTo(y1.x, y1.y);\n            _this.ctx.lineTo(x2.x, x2.y);\n            color = y2;\n            settings = x3;\n        }\n        else {\n            _this.ctx.moveTo(x1, y1);\n            _this.ctx.lineTo(x2, y2);\n            _this.ctx.lineTo(x3, y3);   \n        }\n        \n        _this.ctx.closePath();\n        _this.topFunction.renderShape(fill, stroke, settings);\n    };\n    this.topFunction.triangle = this.topFunction.drawTriangle;\n    this.topFunction.tri = this.topFunction.drawTriangle;\n    \n    //DrawTriangleEquilateral\n    this.topFunction.drawTriangleEquilateral = function(x, y, radius, fill, stroke, settings) {\n        var x1 = x + Math.cos(30 * Math.PI / 180) * ((settings && settings.width) || radius);\n        var y1 = y + Math.sin(30 * Math.PI / 180) * ((settings && settings.height) || radius);\n        \n        var x2 = x + Math.cos(150 * Math.PI / 180) * ((settings && settings.width) || radius);\n        var y2 = y + Math.sin(150 * Math.PI / 180) * ((settings && settings.height) || radius);\n        \n        var x3 = x;\n        var y3 = y - radius;\n        \n        _this.topFunction.drawTriangle(x1, y1, x2, y2, x3, y3, fill, stroke, settings);\n    };\n    this.topFunction.triangleEq = this.topFunction.drawTriangleEquilateral;\n    \n    this.topFunction.drawRegularPolygon = function(x, y, radius, vertices, fill, stroke, settings) {\n        _this.ctx.beginPath();\n        for (var i = -90; i < 270; i += 360 / vertices) {\n            var x1 = x + Math.cos(i * Math.PI / 180) * ((settings && settings.width) || radius);\n            var y1 = y + Math.sin(i * Math.PI / 180) * ((settings && settings.height) || radius);\n            if (i == -90) _this.ctx.moveTo(x1, y1);\n            else          _this.ctx.lineTo(x1, y1);\n        }\n        \n        _this.ctx.closePath();\n        _this.topFunction.renderShape(fill, stroke, settings);\n    };\n    this.topFunction.regPolygon = this.topFunction.drawRegularPolygon;\n    \n    //DrawEllipse\n    this.topFunction.drawEllipse = function(x, y, width, height, fill, stroke, settings) {\n        _this.ctx.beginPath();\n        _this.ctx.ellipse(x, y, width, height, (settings && settings.rotation) || 0, 0, Math.PI * 2);\n        \n        _this.ctx.closePath();\n        _this.topFunction.renderShape(fill, stroke, settings);\n    };\n    this.topFunction.ellipse = this.topFunction.drawEllipse;\n    this.topFunction.oval = this.topFunction.drawEllipse;\n    \n    //PreloadImage\n    this.topFunction.preloadImage = function(src) {\n        var element = _this.preloadedImages.find(function(elem) {return elem.src === src;});\n        console.log(\"Preloading image... \" + src);\n        if (!element) {\n            _this.imagesToLoad++;\n            var img = new Image();\n            img.src = src;\n            img.onload = function() {\n                _this.imagesToLoad--;\n                if (_this.imagesToLoad <= 0) {\n                    _this.callFunctions();\n                }\n                console.log(\"Image preloaded! \" + img.src);\n            }\n            _this.preloadedImages.push({\n                src: src,\n                image: img\n            });\n            \n            return img;\n        }\n    }\n    \n    //DrawImage\n    this.topFunction.drawImage = function(src, x, y, width, height, settings) {\n        var loadedImage = _this.preloadedImages.find(function(elem) {return elem.src === src;});\n        if (loadedImage) {\n            if (settings && settings.rotation !== undefined && settings.rotation !== null) {\n                _this.ctx.save();\n                _this.ctx.translate(x, y);\n                _this.ctx.rotate(settings.rotation);\n                _this.ctx.drawImage(loadedImage.image, -width / 2, -height / 2, width, height);\n                _this.ctx.restore();\n            }\n            else {\n                _this.ctx.drawImage(loadedImage.image, x, y, width, height);\n            }\n        }\n        else {\n            var prel = _this.topFunction.preloadImage(src);\n            prel.onload = function() {_this.ctx.drawImage(prel, x, y, width, height);};\n        }\n    };\n    this.topFunction.image = this.topFunction.drawImage;\n    this.topFunction.picture = this.topFunction.drawImage;\n    \n    this.topFunction.imageReadPixel = function(imageSrc, x, y) {\n        var reader = _this.storedImageData.find(function(elem) {return elem.src === imageSrc;});\n        if (reader) {\n            if (reader.imagePixelReader.isDoneLoading)\n                return reader.imagePixelReader.readPixel(x, y);\n            else\n                return \"Data is added, but has not loaded yet\";\n        }\n        else {\n            var newReader = new _this.topFunction.ImagePixelReader(imageSrc);\n            _this.storedImageData.push({\n                src: imageSrc,\n                imagePixelReader: newReader\n            });\n            return newReader.readPixel(x, y);\n        }\n    }\n    \n    //ImagePixelReader\n    this.topFunction.ImagePixelReader = function(imageSrc) {\n        var top = this;\n        \n        var loadedImage = _this.preloadedImages.find(function(elem) {return elem.src === imageSrc;});\n        if (loadedImage) {\n            top.image = loadedImage.image;\n            top.isDoneLoading = true;\n            top.canvas = document.createElement(\"canvas\");\n            top.canvas.width = top.image.width;\n            top.canvas.height = top.image.height;\n            top.ctx = top.canvas.getContext(\"2d\");\n        \n            top.ctx.drawImage(top.image, 0, 0);\n            top.imageData = top.ctx.getImageData(0, 0, top.image.width, top.image.height).data;\n        }\n        else {\n            console.error(\"Please preload image before getting data!\");\n            /*this.isDoneLoading = false;\n            this.image.onload = function() {\n                top.canvas = document.createElement(\"canvas\");\n                top.canvas.width = top.image.width;\n                top.canvas.height = top.image.height;\n                top.ctx = top.canvas.getContext(\"2d\");\n            \n                top.ctx.drawImage(top.image, 0, 0);\n                top.imageData = top.ctx.getImageData(0, 0, top.image.width, top.image.height).data;\n                top.isDoneLoading = true;\n                \n                top.onload();\n            }*/\n        }\n        \n        this.readPixel = function(x, y) {\n            if (top.isDoneLoading) {\n                var index = (x + y * top.image.height) * 4;\n                return [top.imageData[index],\n                        top.imageData[index + 1],\n                        top.imageData[index + 2],\n                        top.imageData[index + 3]];\n            }\n            else {\n                console.log(\"Is loading!..\");\n            }\n        }\n        \n        this.onload = function() {};\n    }\n    \n    //DrawLine\n    this.topFunction.drawLine = function(x1, y1, x2, y2, color, settings) {\n        _this.ctx.beginPath();\n        if (x1.hasOwnProperty(\"x\")) {\n            _this.ctx.moveTo(x1.x, x1.y);\n            _this.ctx.lineTo(y1.x, y1.y);\n            color = x2;\n            settings = y2;\n        }\n        else {\n            _this.ctx.moveTo(x1, y1);\n            _this.ctx.lineTo(x2, y2); \n        }\n        \n        _this.ctx.closePath();\n        _this.ctx.lineCap = (settings && settings.roundedCorners) ? \"round\" : \"butt\";\n        _this.ctx.strokeStyle = color;\n        _this.ctx.lineWidth = (settings && settings.lineWidth) || 2;\n        _this.ctx.stroke();\n    }\n    this.topFunction.line = this.topFunction.drawLine;\n    \n    //DrawPoint\n    this.topFunction.drawPoint = function(x, y) {\n        if (x.hasOwnProperty(\"x\")) {\n            y = x.y;\n            x = x.x;\n        }\n        _this.topFunction.drawCircle(x, y, 5, \"black\");\n    }\n    this.topFunction.point = this.topFunction.drawPoint;\n    \n    //DrawText\n    this.topFunction.drawText = function(text, x, y, fontSize, fill, stroke, settings) {\n        if (typeof stroke === \"object\" && stroke.toString() === \"[object Object]\") {\n            settings = stroke;\n            stroke = \"\";\n        }\n        _this.ctx.beginPath();\n        _this.ctx.font = (fontSize || 30) + \"px \" + (settings && settings.fontFamily) || \"Arial\";\n        \n        _this.ctx.textAlign = (settings && settings.alignText) || \"left\";\n        _this.ctx.lineWidth = (settings && settings.lineWidth) || 2;\n        _this.ctx.closePath();\n        if (fill) {_this.ctx.fillStyle = fill; _this.ctx.fillText(text, x, y);}\n        if (stroke) {_this.ctx.strokeStyle = stroke; _this.ctx.strokeText(text, x, y);}\n    }\n    this.topFunction.text = this.topFunction.drawText;\n    \n    //RenderShape\n    this.topFunction.drawPolygon = function(list, fill, stroke, settings) {\n        var newList = (list.constructor === Array ? list : arguments);\n        _this.ctx.beginPath();\n        _this.ctx.moveTo(newList[0].x, newList[0].y);\n        for (var i = 1; i < newList.length; i++) {\n            var p = newList[i];\n            _this.ctx.lineTo(p.x, p.y);\n        }\n        _this.ctx.closePath();\n        _this.topFunction.renderShape(fill, stroke, settings);\n    };\n    this.topFunction.polygon = this.topFunction.drawPolygon;\n    \n    this.topFunction.gradient = function(startColor, endColor, radius, settings) {\n        var arr;\n        if (startColor.constructor === Array) {\n            settings = radius;\n            radius = endColor;\n            arr = startColor;\n        }\n        else {\n            arr = [startColor, endColor];\n        }\n        var gradient = _this.ctx.createLinearGradient(0, 0, 0, radius || 100);\n        for (var i = 0; i < arr.length; i++) {\n            gradient.addColorStop((1 / (arr.length - 1)) * i, arr[i]);\n        }\n        return gradient;\n    }\n    \n    //Custom shape\n    \n    this.topFunction.beginShape = function() {\n        _this.ctx.beginPath();\n    }\n    \n    this.topFunction.moveTo = function(x, y) {\n        _this.ctx.moveTo(x, y);\n    }\n    \n    this.topFunction.lineTo = function(x, y) {\n        _this.ctx.lineTo(x, y);\n    }\n    \n    this.topFunction.curveTo = function(x, y, x2, y2) {\n        _this.ctx.quadraticCurveTo(x2, y2, x, y);\n    }\n    \n    this.topFunction.closeShape = function() {\n        _this.ctx.closePath();\n    }\n    \n    this.topFunction.renderShape = function(fill, stroke, settings) {\n        if (typeof fill === \"object\" && fill.toString() === \"[object Object]\") {\n            settings = fill;\n            fill = \"\";\n        }\n        if (typeof stroke === \"object\" && stroke.toString() === \"[object Object]\") {\n            settings = stroke;\n            stroke = \"\";\n        }\n        _this.ctx.lineJoin = (settings && settings.roundedCorners) ? \"round\" : \"miter\";\n        _this.ctx.lineWidth = (settings && settings.lineWidth) || 2;\n        if (settings && settings.hasOwnProperty(\"fillColor\")) {_this.ctx.fillStyle = settings.fillColor; _this.ctx.fill();}\n        if (settings && settings.hasOwnProperty(\"strokeColor\")) {_this.ctx.strokeStyle = settings.strokeColor; _this.ctx.stroke();}\n        \n        if (fill) {_this.ctx.fillStyle = fill; _this.ctx.fill();}\n        if (stroke) {_this.ctx.strokeStyle = stroke; _this.ctx.stroke();}\n    }\n    \n    \n    /*\n    +------------------------------+\n    |      Pixel manipulation      |\n    +------------------------------+\n    */\n    \n    this.topFunction.pixels = [];\n    this.imageData;\n    \n    this.topFunction.updatePixelData = function() {\n        _this.imageData = _this.ctx.getImageData(0, 0, _this.canvas.width, _this.canvas.height);\n        _this.topFunction.pixels = _this.imageData.data;\n    }\n    \n    this.topFunction.updatePixel = function(x, y, r, g, b, a) {\n        var index = (x + y * _this.canvas.width) * 4;\n        _this.topFunction.pixels[index    ] = r;\n        _this.topFunction.pixels[index + 1] = g;\n        _this.topFunction.pixels[index + 2] = b;\n        _this.topFunction.pixels[index + 3] = typeof a === 'undefined' ? 255 : a;\n    }\n    \n    this.topFunction.readPixel = function(x, y) {\n        var index = (x + y * _this.canvas.width) * 4;\n        return [_this.topFunction.pixels[index],\n                _this.topFunction.pixels[index + 1],\n                _this.topFunction.pixels[index + 2],\n                _this.topFunction.pixels[index + 3]];\n    }\n    \n    this.topFunction.renderPixelData = function() {\n        _this.ctx.putImageData(_this.imageData, 0, 0);\n    }\n    \n    \n    /*\n    +------------------------------+\n    |             Math             |\n    +------------------------------+\n    */\n    \n    \n    //Distance\n    this.topFunction.getDistance = function(x1, y1, x2, y2) {\n        if (x1.hasOwnProperty(\"x\")) {\n            y2 = y1.y;\n            x2 = y1.x;\n            y1 = x1.y;\n            x1 = x1.x;\n        }\n        var a = x1 - x2;\n        var b = y1 - y2;\n        return Math.sqrt(a * a + b * b);\n    }\n    this.topFunction.distance = this.topFunction.getDistance;\n    \n    //Angle\n    this.topFunction.getAngle = function(x1, y1, x2, y2, settings) {\n        if (x1.hasOwnProperty(\"x\")) {\n            settings = x2;\n            y2 = y1.y;\n            x2 = y1.x;\n            y1 = x1.y;\n            x1 = x1.x;\n        }\n        if (settings && settings.angleMode && (settings.angleMode.toUpperCase() == \"DEG\" || settings.angleMode.toUpperCase() == \"DEGREES\"))\n            return Math.atan2(y2 - y1, x2 - x1) * 180 / Math.PI;\n        else if ((settings && settings.angleMode && (settings.angleMode.toUpperCase() == \"RAD\" || settings.angleMode.toUpperCase() == \"RADIUS\")) || !settings)\n            return Math.atan2(y2 - y1, x2 - x1);\n    }\n    \n    //Random functions\n    \n    this.topFunction.random = function(min, max) {\n        if (typeof max == \"undefined\")\n            return Math.random() * min;\n        else\n            return Math.random() * (max - min) + min;\n    }\n    \n    this.topFunction.randomInt = function(min, max) {\n        if (typeof max == \"undefined\")\n            return (Math.random() * min) >> 0;\n        else\n            return (Math.random() * (max - min) + min) >> 0;\n    }\n    \n    this.topFunction.randomArray = function(array) {\n        return array[(Math.random() * array.length) >> 0];\n    }\n    \n    \n    /*\n    +------------------------------+\n    |        Export canvas         |\n    +------------------------------+\n    */\n    \n    \n    this.topFunction.canvasToURL = function() {\n        return _this.canvas.toDataURL();\n    }\n    \n    this.topFunction.canvasToImage = function() {\n        var img = new Image();\n        img.src = _this.canvas.toDataURL();\n        return img;\n    }\n    \n    this.topFunction.downloadCanvasPNG = function(filename) {\n        var a = document.createElement(\"a\");\n        a.download = filename || \"downloadCanvasPNG.png\";\n        a.href = _this.canvas.toDataURL();\n        a.click();\n    }\n    \n    \n    /*\n    +------------------------------+\n    |              Misc.           |\n    +------------------------------+\n    */\n    \n    \n    this.topFunction.swap = function(a, b) {\n        return [b, a];\n    }\n    \n    this.topFunction.createArray = function(n, lengths) {\n        return create2dArray(0, n, lengths || 10);\n    }\n    \n    function create2dArray(count, n, lengths) {\n        var a = new Array(lengths);\n        for (var i = 0; i < a.length; i++) {\n            a[i] = count < n - 2 ? create2dArray(count + 1, n, lengths) : new Array(lengths);\n        }\n        return a;\n    }\n    \n    \n    /*\n    +------------------------------+\n    |         Input / events       |\n    +------------------------------+\n    */\n    \n    \n    this.topFunction.mouse = {x: 0, y: 0, left: false, middle: false, right: false};\n    this.topFunction.mouseX = 0;\n    this.topFunction.mouseY = 0;\n    this.topFunction.touch = {x: 0, y: 0, touching: false, touches: []};\n    this.keyNumber = [];\n    this.keyName = [];\n    \n    this.topFunction.isKeyPressed = function(key) {\n        if (isNaN(key))\n            return _this.keyName[key] ? true : false;\n        else\n            return _this.keyNumber[key] ? true : false;\n    }\n    this.topFunction.getKey = this.topFunction.isKeyPressed;\n    \n    this.canvas.addEventListener(\"mousemove\", function(e) {\n        var rect = _this.canvas.getBoundingClientRect();\n        _this.topFunction.mouse.x = _this.topFunction.mouseX = Math.round((e.clientX - rect.left) * (_this.topFunction.width / rect.width));\n        _this.topFunction.mouse.y = _this.topFunction.mouseY = Math.round((e.clientY - rect.top) * (_this.topFunction.height / rect.height));\n        typeof OnMouseMove === \"function\" && OnMouseMove(e);\n    });\n    \n    this.canvas.addEventListener(\"mousedown\", function(e) {\n        switch (e.which) {\n            case 1:\n                _this.topFunction.mouse.left = true;\n                break;\n            case 2:\n                _this.topFunction.mouse.middle = true;\n                break;\n            case 3:\n                _this.topFunction.mouse.right = true;\n                break;\n        }\n        typeof OnMouseDown === \"function\" && OnMouseDown(e);\n    });\n    \n    this.canvas.addEventListener(\"mouseup\", function(e) {\n        switch (e.which) {\n            case 1:\n                _this.topFunction.mouse.left = false;\n                break;\n            case 2:\n                _this.topFunction.mouse.middle = false;\n                break;\n            case 3:\n                _this.topFunction.mouse.right = false;\n                break;\n        }\n        typeof OnMouseUp === \"function\" && OnMouseUp(e);\n    });\n    \n    this.canvas.addEventListener(\"touchstart\", function(e) {\n        e.preventDefault();\n        changeTouch(e);\n        _this.topFunction.touch.x = e.touches[0].pageX;\n        _this.topFunction.touch.y = e.touches[0].pageY;\n        _this.topFunction.touch.touching = true;\n        \n        typeof OnTouchStart === \"function\" && OnTouchStart(e);\n    });\n    \n    this.canvas.addEventListener(\"touchend\", function(e) {\n        e.preventDefault();\n        changeTouch(e);\n        _this.topFunction.touch.touching = false;\n        \n        typeof OnTouchEnd === \"function\" && OnTouchEnd(e);\n    });\n    \n    this.canvas.addEventListener(\"touchmove\", function(e) {\n        e.preventDefault();\n        changeTouch(e);\n        if (_this.settings.setMouseToTouch) {\n            _this.topFunction.touch.x = _this.topFunction.mouse.x = _this.topFunction.mouseX = e.touches[0].pageX;\n            _this.topFunction.touch.y = _this.topFunction.mouse.y = _this.topFunction.mouseY = e.touches[0].pageY;\n        }\n        else {\n            _this.topFunction.touch.x = e.touches[0].pageX;\n            _this.topFunction.touch.y = e.touches[0].pageY;\n        }\n        \n        typeof OnTouchMove === \"function\" && OnTouchMove(e);\n    });\n    \n    var changeTouch = function(e) {\n        _this.topFunction.touch.touches = [];\n        for (var i = 0; i < e.touches.length; i++) {\n            _this.topFunction.touch.touches.push({x: e.touches[i].pageX, y: e.touches[i].pageY, id: e.touches[i].identifier});\n        }\n    }\n    \n    document.addEventListener(\"keydown\", function(e) {\n        _this.keyNumber[e.which] = true;\n        _this.keyName[e.key] = true;\n        typeof OnKeyDown === \"function\" && OnKeyDown(e);\n    });\n    \n    document.addEventListener(\"keyup\", function(e) {\n        _this.keyNumber[e.which] = false;\n        _this.keyName[e.key] = false;\n        typeof OnKeyUp === \"function\" && OnkeyUp(e);\n    });\n}"]},"metadata":{},"sourceType":"module"}